# Global configuration
global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: ""

# Application configuration
app:
  name: "complex-microservices"
  namespace: "microservices-test"
  environment: "testing"

# Frontend application
frontend:
  enabled: true
  name: "frontend"
  image:
    repository: "nginx"
    tag: "1.21-alpine"
    pullPolicy: "IfNotPresent"
  replicas: 2
  service:
    type: ClusterIP
    port: 80
    targetPort: 80
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  ingress:
    enabled: true
    className: "nginx"
    annotations:
      nginx.ingress.kubernetes.io/rewrite-target: /
    hosts:
      - host: "frontend.local"
        paths:
          - path: /
            pathType: Prefix

# Backend API service
backend:
  enabled: true
  name: "backend-api"
  image:
    repository: "node"
    tag: "18-alpine"
    pullPolicy: "IfNotPresent"
  replicas: 3
  service:
    type: ClusterIP
    port: 3000
    targetPort: 3000
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    - name: DATABASE_URL
      value: "postgresql://postgres:password@postgresql:5432/appdb"
    - name: REDIS_URL
      value: "redis://redis:6379"
    - name: RABBITMQ_URL
      value: "amqp://user:password@rabbitmq:5672"
    - name: NODE_ENV
      value: "production"

# Worker service
worker:
  enabled: true
  name: "worker"
  image:
    repository: "python"
    tag: "3.11-alpine"
    pullPolicy: "IfNotPresent"
  replicas: 2
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  env:
    - name: RABBITMQ_URL
      value: "amqp://user:password@rabbitmq:5672"
    - name: REDIS_URL
      value: "redis://redis:6379"

# Monitoring service
monitoring:
  enabled: true
  name: "prometheus"
  image:
    repository: "prom/prometheus"
    tag: "v2.45.0"
    pullPolicy: "IfNotPresent"
  replicas: 1
  service:
    type: ClusterIP
    port: 9090
    targetPort: 9090
  resources:
    requests:
      memory: "512Mi"
      cpu: "200m"
    limits:
      memory: "1Gi"
      cpu: "500m"

# Database configuration
postgresql:
  enabled: true
  auth:
    postgresPassword: "postgres"
    database: "appdb"
  primary:
    persistence:
      enabled: false
      size: 8Gi
    resources:
      requests:
        memory: "256Mi"
        cpu: "200m"
      limits:
        memory: "512Mi"
        cpu: "500m"

# Redis configuration
redis:
  enabled: true
  auth:
    enabled: false
  master:
    persistence:
      enabled: false
      size: 2Gi
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
      limits:
        memory: "256Mi"
        cpu: "200m"

# RabbitMQ configuration
rabbitmq:
  enabled: true
  auth:
    username: "user"
    password: "password"
  persistence:
    enabled: false
    size: 4Gi
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"

# Network policies
networkPolicies:
  enabled: true
  defaultDeny: true

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
  hosts:
    - host: "api.local"
      paths:
        - path: /api
          pathType: Prefix
          service: backend
    - host: "monitoring.local"
      paths:
        - path: /
          pathType: Prefix
          service: monitoring

# NodePort Services
nodePort:
  enabled: true
  frontend:
    port: 30080
  backend:
    port: 30081
  monitoring:
    port: 30082
  postgresql:
    port: 30083
  redis:
    port: 30084
  rabbitmq:
    amqpPort: 30085
    managementPort: 30086
    metricsPort: 30087

# Service accounts and RBAC
serviceAccount:
  create: true
  name: "microservices-sa"
  annotations: {}

rbac:
  create: true

# ConfigMaps and Secrets
configMaps:
  appConfig:
    data:
      LOG_LEVEL: "info"
      MAX_CONNECTIONS: "100"
      TIMEOUT: "30s"

secrets:
  appSecrets:
    data:
      JWT_SECRET: "your-jwt-secret-here"
      API_KEY: "your-api-key-here"
